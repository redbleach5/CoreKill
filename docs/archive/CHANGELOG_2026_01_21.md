# Changelog ‚Äî 2026-01-21

## üöÄ –£–ª—É—á—à–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `_streaming_*` —Å–æ–∑–¥–∞–≤–∞–ª–∏ race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω `StreamingAgentsCache` —Å `threading.Lock`
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- ‚úÖ –õ–µ–Ω–∏–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ `_get_streaming_agent_for_state()`

**–§–∞–π–ª—ã:**
- `infrastructure/streaming_agents_cache.py` ‚Äî –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å

### –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (WorkflowConfig)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è workflow –±—ã–ª–∞ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –∫–æ–¥—É.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å `WorkflowConfig` –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
- ‚úÖ –ú–µ—Ç–æ–¥—ã: `streaming_enabled`, `should_use_incremental()`, `get_stage_timeout()`, `get_temperature()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `workflow_nodes.py` –∏ `coder_node`

**–§–∞–π–ª—ã:**
- `infrastructure/workflow_config.py` ‚Äî –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å

### –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @streaming_node

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —É–∑–ª–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@streaming_node` –¥–ª—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ `EventStore`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

**–§–∞–π–ª—ã:**
- `infrastructure/workflow_decorators.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä

### EventStore –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ `state["sse_events"]`, —Ä–∞–∑–¥—É–≤–∞—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `EventStore` (–≤–Ω–µ state)
- ‚úÖ –í state —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è (`event_references`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π (TTL = 1 —á–∞—Å)
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ session_id

**–§–∞–π–ª—ã:**
- `infrastructure/event_store.py` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–ª–∞—Å—Å–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

### –£–ª—É—á—à–µ–Ω–∏—è IntentAgent

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è greeting
- –†–∞–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è structured/legacy
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ IntentResponse ‚Üî IntentResult
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ confidence
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏—è:**
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ `is_greeting_fast()` –∏ `_is_greeting()`
- ‚úÖ –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ `_get_prompt()` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —è–∑—ã–∫–æ–≤
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `_response_to_result()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è confidence —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ (`_detect_language()`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–¥–æ 1000 –∑–∞–ø–∏—Å–µ–π)

**–§–∞–π–ª—ã:**
- `agents/intent.py` ‚Äî —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

### –¢–∏–ø–∏–∑–∞—Ü–∏—è

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ `infrastructure/workflow_types.py` ‚Äî Protocol –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è `WorkflowNode` –∏ `StreamingWorkflowNode`

## üìù –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ `ARCHITECTURE.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–∑–¥–µ–ª—ã –æ –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚úÖ `.cursor/rules/architecture.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
- ‚úÖ `DOCS_INDEX.md` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è
- ‚úÖ `README.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∏—á–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `_streaming_planner`, `_streaming_test_generator`, `_streaming_coder` –∏ –¥—Ä—É–≥–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `_current_streaming_model` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
- `_initialize_streaming_agents()` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- `SIMPLE_GREETINGS` ‚Äî –¥—É–±–ª–∏—Ä—É—é—â–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –≤ IntentAgent
- `_classify_legacy_response()` ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –º–µ—Ç–æ–¥

### –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `StreamingAgentsCache` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à
- `WorkflowConfig` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `@streaming_node` ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —É–∑–ª–æ–≤
- `_calibrate_confidence()` ‚Äî –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- `_detect_language()` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
- `_get_prompt()` ‚Äî –µ–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
- `_response_to_result()` ‚Äî —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ race condition –≤ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–∞—Ö
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É structured/legacy —Ä–µ–∂–∏–º–∞–º–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–∞–º—è—Ç—å —á–µ—Ä–µ–∑ EventStore
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 4
- **–ò–∑–º–µ–Ω–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 6
- **–£–¥–∞–ª–µ–Ω–æ:** 8 –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö + 2 —Ñ—É–Ω–∫—Ü–∏–∏
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –º–µ—Ç–æ–¥–æ–≤:** 7
- **–£–ª—É—á—à–µ–Ω–æ —É–∑–ª–æ–≤:** 7 —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —É–∑–ª–æ–≤
