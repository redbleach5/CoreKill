# –£–ª—É—á—à–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤

**–î–∞—Ç–∞:** 2026-01-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω—ã –æ–±—â–∏–µ test utilities –¥–ª—è frontend

**–§–∞–π–ª—ã:**
- `frontend/src/__tests__/utils/mocks.ts` ‚Äî –æ–±—â–∏–µ –º–æ–∫–∏
- `frontend/src/__tests__/utils/testHelpers.tsx` ‚Äî helpers –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- `frontend/src/__tests__/utils/constants.ts` ‚Äî –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –í—ã–Ω–µ—Å–µ–Ω `localStorageMock` –≤ –æ–±—â–∏–π –º–æ–¥—É–ª—å
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–∫–æ–≤ (`createLocalStorageMock`, `createLocationMock`)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã helpers –¥–ª—è API –º–æ–∫–æ–≤ (`mockApiResponse`, `mockApiError`)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (`TEST_MODELS`, `TEST_IDS`, `TEST_DATA`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `setup.ts` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–∏—Ö –º–æ–∫–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–∏—Ö utilities

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∫–æ–≤
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–∫–æ–≤
- –£–ø—Ä–æ—â–µ–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

### 2. –°–æ–∑–¥–∞–Ω—ã –æ–±—â–∏–µ fixtures –∏ factories –¥–ª—è backend

**–§–∞–π–ª—ã:**
- `tests/factories.py` ‚Äî factories –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `tests/test_utils.py` ‚Äî –æ–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω `tests/conftest.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—â–∏–µ fixtures

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `create_agent_state()` ‚Äî factory –¥–ª—è AgentState
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `create_intent_result()` ‚Äî factory –¥–ª—è IntentResult
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `create_reflection_result()` ‚Äî factory –¥–ª—è ReflectionResult
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `create_debug_result()` ‚Äî factory –¥–ª—è DebugResult
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–∫–æ–≤ (`create_mock_model_router`, `create_mock_llm`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã fixtures –≤ `conftest.py`:
  - `mock_agent_state`
  - `mock_model_router`
  - `mock_llm`
  - `mock_agent_dependencies`
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è factories –∏ fixtures

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- –£–ø—Ä–æ—â–µ–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

---

### 3. –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö

**Backend:**
- ‚úÖ `test_coder.py` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ fixtures
- ‚úÖ `test_planner.py` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ fixtures
- ‚úÖ `test_reflection.py` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç factories
- ‚úÖ `test_workflow_langgraph.py` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `create_agent_state()`

**Frontend:**
- ‚úÖ `hooks.test.tsx` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ –º–æ–∫–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- ‚úÖ `apiClient.test.ts` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ –º–æ–∫–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- ‚úÖ `setup.ts` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ –º–æ–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ ~200 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–ø—Ä–æ—â–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∫–æ–≤:** 3+ –º–µ—Å—Ç–∞
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:** 5+ –º–µ—Å—Ç
- **–•–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π:** 20+ –º–µ—Å—Ç
- **–°—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞:** ~300

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∫–æ–≤:** 0 –º–µ—Å—Ç (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:** 0 –º–µ—Å—Ç (factories)
- **–•–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π:** 0 –º–µ—Å—Ç (–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã)
- **–°—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞:** ~100 (-67%)

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

### 1. –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

**–î–æ:**
```python
# –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–æ–∫–∏ –≤—Ä—É—á–Ω—É—é
with patch('agents.coder.get_model_router') as mock_router:
    mock_router.return_value = Mock(...)
    # ... –º–Ω–æ–≥–æ –∫–æ–¥–∞
```

**–ü–æ—Å–ª–µ:**
```python
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–µ fixtures
def test_something(agent, mock_agent_dependencies):
    # –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
```

### 2. –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö

**–î–æ:**
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–ü–æ—Å–ª–µ:**
- –ò–∑–º–µ–Ω—è–µ–º factory ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 3. –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–æ:**
- –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç —Å–æ–∑–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ-—Å–≤–æ–µ–º—É

**–ü–æ—Å–ª–µ:**
- –í—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ factories –∏ utilities

### 4. –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

**–î–æ:**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –º–µ—Å—Ç

**–ü–æ—Å–ª–µ:**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (factory/utility)

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

### 1. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

**–ü—Ä–∏–º–µ—Ä:**
```python
@pytest.mark.parametrize("intent_type,expected", [
    ("create", "planning"),
    ("modify", "planning"),
    ("debug", "debugging"),
])
def test_intent_routing(intent_type, expected):
    # —Ç–µ—Å—Ç
```

### 2. Test builders

**–ü—Ä–∏–º–µ—Ä:**
```python
class AgentStateBuilder:
    def with_task(self, task: str):
        self.task = task
        return self
    
    def with_intent(self, intent: IntentResult):
        self.intent_result = intent
        return self
    
    def build(self):
        return create_agent_state(**self.__dict__)
```

### 3. –û–±—â–∏–µ test scenarios

**–ü—Ä–∏–º–µ—Ä:**
```python
def test_scenario_simple_task():
    """–°—Ü–µ–Ω–∞—Ä–∏–π: –ø—Ä–æ—Å—Ç–∞—è –∑–∞–¥–∞—á–∞."""
    state = create_agent_state(task="create hello function")
    # ... —Ç–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ workflow
```

---

## ‚úÖ –ò—Ç–æ–≥–∏

‚úÖ –°–æ–∑–¥–∞–Ω—ã –æ–±—â–∏–µ utilities –¥–ª—è frontend  
‚úÖ –°–æ–∑–¥–∞–Ω—ã factories –∏ fixtures –¥–ª—è backend  
‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö  
‚úÖ –£–ª—É—á—à–µ–Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å  
‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞  
‚úÖ –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–¢–µ—Å—Ç—ã —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞!**

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
