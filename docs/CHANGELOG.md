# История изменений проекта

**Последнее обновление:** 2026-01-21

---

## 2026-01-21

### ✅ Завершен полный рефакторинг проекта

#### Backend рефакторинг
- **Фаза 1:** Создан `BaseAgent`, устранено ~1400 строк дублирующегося кода
- **Фаза 2:** Унифицирована логика создания агентов и промптов, устранено ~450 строк дублирующегося кода
- **Итого:** Устранено ~1850 строк дублирующегося кода

#### Frontend рефакторинг
- **Фаза 1:** Создан централизованный API клиент, мигрировано 9 компонентов, устранено ~200 строк дублирующегося кода
- **Фаза 2:** Устранено дублирование типов, созданы кастомные хуки, мигрировано 4 компонента, устранено ~100 строк дублирующегося кода
- **Фаза 3:** Созданы общие UI компоненты и helper для SSE, оптимизированы компоненты, устранено ~160 строк дублирующегося кода
- **Итого:** Устранено ~460 строк дублирующегося кода

#### Общие улучшения
- Улучшена поддерживаемость кода
- Улучшена читаемость
- Улучшена типобезопасность
- Единые точки для изменений
- Упрощена поддержка и развитие

**Детали:** См. [REFACTORING_HISTORY.md](REFACTORING_HISTORY.md)

---

## Ранее

### Исправления стриминга
- Исправлены проблемы с memory leaks в EventStore
- Добавлена периодическая очистка сессий
- Улучшена обработка ошибок в reasoning_stream.py
- Добавлены missing events (thinking_completed, thinking_interrupted)

### Улучшения архитектуры
- Потокобезопасный кэш стриминговых агентов
- Централизованная конфигурация (WorkflowConfig)
- Декоратор @streaming_node для унификации стриминга
- EventStore для оптимизации памяти
- Circuit Breaker для защиты от каскадных сбоев

### Улучшения IntentAgent
- Кэширование результатов
- Калибровка confidence
- Определение языка запроса

---

**Для полной истории изменений см. git log**
