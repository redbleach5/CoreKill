# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Cursor Killer

## –û–±–∑–æ—Ä

Cursor Killer ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –º–Ω–æ–≥–æ–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞ —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º UX, –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π IDE –∏ —É–º–Ω—ã–º –≤—ã–±–æ—Ä–æ–º –º–æ–¥–µ–ª–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç LangGraph –¥–ª—è workflow –∏ Ollama –¥–ª—è LLM.

**–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ **2026-01-21: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è workflow** ‚Äî –≤—Å–µ —Ä–µ–∂–∏–º—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –≥—Ä–∞—Ñ LangGraph
- ‚úÖ **2026-01-21: –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞** ‚Äî —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ —É–∑–ª—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –≥—Ä–∞—Ñ —á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä—ã
- ‚úÖ **2026-01-21: –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞** ‚Äî —É–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É –æ–±—ã—á–Ω—ã–º–∏ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–º–∏ –ø—É—Ç—è–º–∏
- ‚úÖ **2026-01-21: –£–ª—É—á—à–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
- ‚úÖ **2026-01-21: –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ **2026-01-21: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** ‚Äî WorkflowConfig –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º
- ‚úÖ **2026-01-21: –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @streaming_node** ‚Äî —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ **2026-01-21: –£–ª—É—á—à–µ–Ω–∏—è IntentAgent** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ confidence, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- **Dependency Inversion** ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `backend/dependencies.py`
- **–Ø–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã** ‚Äî –∫–∞–∂–¥—ã–π —Å–ª–æ–π –∏–º–µ–µ—Ç —á—ë—Ç–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **UI –Ω–µ –∑–Ω–∞–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤** ‚Äî frontend –æ–±—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API
- **–õ—é–±–∞—è —Ñ–∏—á–∞ –æ—Ç–∫–ª—é—á–∞–µ–º–∞** ‚Äî —á–µ—Ä–µ–∑ `config.toml` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥–µ–ª–µ–π –æ—Ç 1B –¥–æ 405B
- **Reasoning Models** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DeepSeek-R1, QwQ —Å –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–æ–º `<think>` –±–ª–æ–∫–æ–≤
- **Structured Output** ‚Äî Pydantic –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `generate_structured()`
- **–£–¥–∞–ª—ë–Ω–Ω—ã–π Ollama** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GPU —á–µ—Ä–µ–∑ Tailscale

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cursor-killer/
‚îú‚îÄ‚îÄ agents/                 # –ê–≥–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ intent.py           # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è + —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ chat.py             # –ê–≥–µ–Ω—Ç –¥–ª—è –¥–∏–∞–ª–æ–≥–æ–≤ (chat —Ä–µ–∂–∏–º)
‚îÇ   ‚îú‚îÄ‚îÄ conversation.py     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ planner.py          # –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ researcher.py       # –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (RAG + –≤–µ–±)
‚îÇ   ‚îú‚îÄ‚îÄ test_generator.py   # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ (TDD)
‚îÇ   ‚îú‚îÄ‚îÄ coder.py            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ debugger.py         # Self-healing
‚îÇ   ‚îú‚îÄ‚îÄ critic.py           # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ reflection.py       # –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ –æ—Ü–µ–Ω–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ memory.py           # –°–∏—Å—Ç–µ–º–∞ –ø–∞–º—è—Ç–∏ (RAG)
‚îú‚îÄ‚îÄ backend/                # FastAPI backend
‚îÇ   ‚îú‚îÄ‚îÄ api.py              # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py     # Dependency Injection
‚îÇ   ‚îú‚îÄ‚îÄ types.py            # –¢–∏–ø—ã –∏ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ sse_manager.py      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSE
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îî‚îÄ‚îÄ agent.py        # API endpoints + —Ä–æ—É—Ç–∏–Ω–≥ —Ä–µ–∂–∏–º–æ–≤
‚îú‚îÄ‚îÄ frontend/               # React + TypeScript + Vite
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ App.tsx         # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ       ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ chat/       # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–∞—Ç–∞
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatInput.tsx    # –ü–æ–ª–µ –≤–≤–æ–¥–∞
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MessageList.tsx  # –°–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WelcomeScreen.tsx
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ header/     # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —à–∞–ø–∫–∏
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppHeader.tsx    # –ì–ª–∞–≤–Ω—ã–π header
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ QuickSettings.tsx
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ChatHistory.tsx  # –°–∞–π–¥–±–∞—Ä –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ IDEPanel.tsx     # –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è IDE
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ CodeEditor.tsx   # –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ SettingsPanel.tsx
‚îÇ       ‚îú‚îÄ‚îÄ hooks/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ useAgentStream.ts  # SSE hook
‚îÇ       ‚îú‚îÄ‚îÄ types/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ chat.ts      # TypeScript —Ç–∏–ø—ã
‚îÇ       ‚îî‚îÄ‚îÄ constants/
‚îÇ           ‚îî‚îÄ‚îÄ sse.ts       # SSE –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îú‚îÄ‚îÄ infrastructure/         # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ local_llm.py        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Ollama (sync/async, JSON –ø–∞—Ä—Å–∏–Ω–≥, ThreadPoolExecutor)
‚îÇ   ‚îú‚îÄ‚îÄ connection_pool.py  # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π Ollama (HTTP/2, connection pooling)
‚îÇ   ‚îú‚îÄ‚îÄ model_router.py     # SmartModelRouter ‚Äî –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–∫—ç—à, fallback)
‚îÇ   ‚îú‚îÄ‚îÄ rag.py              # RAG —Å ChromaDB
‚îÇ   ‚îú‚îÄ‚îÄ web_search.py       # –í–µ–±-–ø–æ–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ task_checkpointer.py # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–¥–∞—á
‚îÇ   ‚îú‚îÄ‚îÄ workflow_state.py   # State —Å—Ö–µ–º–∞ LangGraph
‚îÇ   ‚îú‚îÄ‚îÄ workflow_nodes.py   # –£–∑–ª—ã –≥—Ä–∞—Ñ–∞
‚îÇ   ‚îú‚îÄ‚îÄ workflow_edges.py   # –£—Å–ª–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ workflow_graph.py   # –ì—Ä–∞—Ñ LangGraph
‚îÇ   ‚îú‚îÄ‚îÄ workflow_config.py  # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è workflow
‚îÇ   ‚îú‚îÄ‚îÄ workflow_decorators.py # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã @workflow_node –∏ @streaming_node
‚îÇ   ‚îú‚îÄ‚îÄ workflow_types.py   # Protocol –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ streaming_agents_cache.py # –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ event_store.py      # –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
‚îÇ   ‚îî‚îÄ‚îÄ circuit_breaker.py   # Circuit Breaker –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ config.toml
‚îÇ   ‚îú‚îÄ‚îÄ model_checker.py    # –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π Ollama
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ config.toml             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ output/
    ‚îî‚îÄ‚îÄ conversations/      # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ (JSON)
```

## Frontend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
App.tsx
‚îú‚îÄ‚îÄ AppHeader              # –®–∞–ø–∫–∞: –ª–æ–≥–æ, —Ä–µ–∂–∏–º—ã, –º–æ–¥–µ–ª—å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ ChatHistory            # –°–∞–π–¥–±–∞—Ä —Å–ª–µ–≤–∞: –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ –£–¥–∞–ª–µ–Ω–∏–µ (–º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ)
‚îú‚îÄ‚îÄ Chat View              # –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ MessageList        # –°–æ–æ–±—â–µ–Ω–∏—è —Å markdown
‚îÇ   ‚îî‚îÄ‚îÄ ChatInput          # –ü–æ–ª–µ –≤–≤–æ–¥–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –≤–Ω–∏–∑—É)
‚îî‚îÄ‚îÄ IDEPanel               # –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è IDE (split/ide —Ä–µ–∂–∏–º)
    ‚îú‚îÄ‚îÄ Project Menu       # –ú–µ–Ω—é: –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É, –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ File Tabs          # –¢–∞–±—ã —Ñ–∞–π–ª–æ–≤
    ‚îú‚îÄ‚îÄ Actions            # –í—ã–ø–æ–ª–Ω–∏—Ç—å, –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, —Å–∫–∞—á–∞—Ç—å
    ‚îî‚îÄ‚îÄ CodeEditor         # –†–µ–¥–∞–∫—Ç–æ—Ä —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
```

### Layout —Ä–µ–∂–∏–º—ã

- **chat** ‚Äî —Ç–æ–ª—å–∫–æ —á–∞—Ç (–∏—Å—Ç–æ—Ä–∏—è —Å–ª–µ–≤–∞)
- **ide** ‚Äî —Ç–æ–ª—å–∫–æ IDE
- **split** ‚Äî —á–∞—Ç + IDE (50/50)

–†–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Ä–µ–∂–∏–º–æ–º –∞–≥–µ–Ω—Ç–∞:
- `mode=chat` ‚Üí layout=chat
- `mode=code` ‚Üí layout=split
- `mode=auto` ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç, –∞–≤—Ç–æ-split –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞

## –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∂–∏–º–æ–≤

### –†–µ–∂–∏–º—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    stream_task_results                   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  mode=chat ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ run_chat_stream ‚îÇ
‚îÇ             (–Ø–í–ù–´–ô –≤—ã–±–æ—Ä, –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ code)     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  mode=code ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ run_workflow_stream ‚îÇ
‚îÇ             (–Ø–í–ù–´–ô –≤—ã–±–æ—Ä, –≤—Å–µ–≥–¥–∞ –ø–æ–ª–Ω—ã–π TDD workflow)   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  mode=auto ‚îÄ‚îÄ‚ñ∫ IntentAgent.is_greeting_fast() ‚îÄ‚îÄ‚ñ∫ chat  ‚îÇ
‚îÇ           ‚îÇ                                              ‚îÇ
‚îÇ           ‚îî‚îÄ‚ñ∫ chat_keywords & !code_keywords ‚îÄ‚îÄ‚ñ∫ chat   ‚îÇ
‚îÇ           ‚îÇ                                              ‚îÇ
‚îÇ           ‚îî‚îÄ‚ñ∫ code_keywords? ‚îÄ‚îÄ‚ñ∫ code                   ‚îÇ
‚îÇ           ‚îÇ                                              ‚îÇ
‚îÇ           ‚îî‚îÄ‚ñ∫ LLM determine_intent() ‚îÄ‚îÄ‚ñ∫ recommended    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ (auto)

| –†–µ–∂–∏–º | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ |
|-------|----------------|
| **chat** | –æ–±—ä—è—Å–Ω–∏, —Ä–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç–∞–∫–æ–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ—á–µ–º—É, –∑–∞—á–µ–º, –ø–æ—Å–æ–≤–µ—Ç—É–π |
| **code** | –Ω–∞–ø–∏—à–∏, —Å–æ–∑–¥–∞–π, —Å–¥–µ–ª–∞–π, —Ä–µ–∞–ª–∏–∑—É–π, —Ñ—É–Ω–∫—Ü–∏, –∫–ª–∞—Å—Å, –∏—Å–ø—Ä–∞–≤, debug |

### ChatAgent ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –¥–∏–∞–ª–æ–≥–∞

–í —Ä–µ–∂–∏–º–µ `chat` ChatAgent:
- **–î–µ–ª–∞–µ—Ç**: –æ–±—ä—è—Å–Ω—è–µ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –æ–±—Å—É–∂–¥–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, –¥–∞—ë—Ç —Å–æ–≤–µ—Ç—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã (–¥–æ 20-30 —Å—Ç—Ä–æ–∫)
- **–ù–ï –¥–µ–ª–∞–µ—Ç**: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Å–∫—Ä–∏–ø—Ç—ã, —Ç–µ—Å—Ç—ã, TDD workflow

–ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–¥–∞ –≤ —Ä–µ–∂–∏–º–µ –¥–∏–∞–ª–æ–≥–∞ ‚Äî –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞".

### –£–º–Ω—ã–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π (SmartModelRouter)

```python
# –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:
SIMPLE  ‚Üí –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –º–æ–¥–µ–ª—å (–±—ã—Å—Ç—Ä–æ—Ç–∞)   ‚Üí phi3:mini, gemma:1b
MEDIUM  ‚Üí –±–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏                ‚Üí qwen2.5-coder:7b
COMPLEX ‚Üí –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ                     ‚Üí 13B+, 30B+, 70B+
```

**–£–ª—É—á—à–µ–Ω–∏—è (2026-01-21):**
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –∫–∞—á–µ—Å—Ç–≤–∞** ‚Äî `min_quality_simple/medium/complex` –≤ `config.toml`
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback** ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∑–∞–ø–∞—Å–Ω—É—é –º–æ–¥–µ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞** ‚Äî –∫—ç—à –Ω–∞ 128 –∑–∞–ø–∏—Å–µ–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏** ‚Äî —É—á—ë—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π RAM –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Ä–æ–≥–æ–≤ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

## –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤

### Backend (ConversationMemory)

```python
# agents/conversation.py
ConversationMemory:
  - get_or_create_conversation(id)
  - add_message(conversation_id, role, content)
  - get_context(conversation_id, max_messages)
  - _summarize_conversation()  # –ê–≤—Ç–æ—Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ output/conversations/{id}.json
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—É–º–º–∞—Ä–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–∏–∞–ª–æ–≥–µ —á–µ—Ä–µ–∑ LLM –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20 —Å–æ–æ–±—â–µ–Ω–∏–π).

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. **–¢—Ä–∏–≥–≥–µ—Ä**: –ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—Å—É–º–º–∞—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–µ–≤—ã—à–∞–µ—Ç `max_messages` (20)
2. **–ü—Ä–æ—Ü–µ—Å—Å**: 
   - –ë–µ—Ä—É—Ç—Å—è –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö `max_messages // 2` (10)
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–º–ø—Ç —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É (2-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
   - –°—Ç–∞—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–µ–π
   - –í –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ø–∞–¥–∞—é—Ç: —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è + –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π

**–£–ª—É—á—à–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ (2026-01-21):**

–ü—Ä–æ–º–ø—Ç —Ç–µ–ø–µ—Ä—å —è–≤–Ω–æ –ø—Ä–æ—Å–∏—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å:
- –û—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º—É/–∑–∞–¥–∞—á—É –æ–±—Å—É–∂–¥–µ–Ω–∏—è
- –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –∏—Ö –ø—Ä–∏—á–∏–Ω—ã
- **–í–∞–∂–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏** (–∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π, –∫–ª–∞—Å—Å–æ–≤, —Ñ–∞–π–ª–æ–≤)
- –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Ä–µ—à–µ–Ω—ã
- –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–∞–∂–µ –≤ –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

### Frontend (ChatHistory)

```typescript
// components/ChatHistory.tsx
- –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –∏–∑ /api/conversations
- –ü–æ–∏—Å–∫ –ø–æ title/preview
- –ö–ª–∏–∫ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ /api/conversations/{id}
- –£–¥–∞–ª–µ–Ω–∏–µ —Å –º–æ–¥–∞–ª—å–Ω—ã–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
- –°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–π —Å–∞–π–¥–±–∞—Ä
```

## IDE Panel

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [üìÅ] [üêç main.py] [üìú utils.js] [+] ‚îÇ [‚ñ∂] [üìã] [‚¨á] [‚Ü∫] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  1 ‚îÇ def hello():                                   ‚îÇ
‚îÇ  2 ‚îÇ     print("Hello")                             ‚îÇ
‚îÇ  3 ‚îÇ                                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –§—É–Ω–∫—Ü–∏–∏

- **–ú–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–∞** [üìÅ]: –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É, –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å, –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å
- **–¢–∞–±—ã —Ñ–∞–π–ª–æ–≤**: –º–Ω–æ–≥–æ—Ñ–∞–π–ª–æ–≤—ã–π —Ä–µ–∂–∏–º, –∑–∞–∫—Ä—ã—Ç–∏–µ
- **–î–µ–π—Å—Ç–≤–∏—è**: –≤—ã–ø–æ–ª–Ω–∏—Ç—å, –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å, —Å–∫–∞—á–∞—Ç—å, —Å–±—Ä–æ—Å–∏—Ç—å
- **–†–µ–¥–∞–∫—Ç–æ—Ä**: –ø–æ–¥—Å–≤–µ—Ç–∫–∞ Python, –Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫

## Workflow Code —Ä–µ–∂–∏–º–∞

### –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥—Ä–∞—Ñ LangGraph

Workflow –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ LangGraph. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ–∂–¥—É –æ–±—ã—á–Ω—ã–º–∏ –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–º–∏ —É–∑–ª–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `use_streaming_agents` –≤ `config.toml`.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å
    ‚Üì
[LangGraph Workflow]
    ‚îú‚îÄ‚îÄ [Intent Agent] ‚Üí greeting/help? ‚Üí END (–±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç)
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Planner Agent] ‚Üí –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    ‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–π: planner_node
    ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π: stream_planner_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Researcher Agent] ‚Üí Codebase Index ‚Üí RAG ‚Üí Web Search
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Test Generator] ‚Üí pytest —Ç–µ—Å—Ç—ã (TDD)
    ‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–π: generator_node
    ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π: stream_generator_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Coder Agent] ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–π: coder_node
    ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π: stream_coder_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
    ‚îÇ       ‚îî‚îÄ‚îÄ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è COMPLEX –∑–∞–¥–∞—á
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Validator] ‚Üí pytest, mypy, bandit
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Debugger] ‚Üê [Fixer] ‚Üê [Validator] (–¥–æ 5 –∏—Ç–µ—Ä–∞—Ü–∏–π)
    ‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–µ: debugger_node, fixer_node
    ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ: stream_debugger_node, stream_fixer_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä—ã)
    ‚îÇ
    ‚îú‚îÄ‚îÄ [Reflection Agent] ‚Üí –æ—Ü–µ–Ω–∫–∞ + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å
    ‚îÇ   ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–π: reflection_node
    ‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π: stream_reflection_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
    ‚îÇ
    ‚îî‚îÄ‚îÄ [Critic Agent] ‚Üí –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
        ‚îú‚îÄ‚îÄ –û–±—ã—á–Ω—ã–π: critic_node
        ‚îî‚îÄ‚îÄ –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π: stream_critic_node (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
```

### –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —É–∑–ª–æ–≤

–°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ —É–∑–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `stream_planner_node`) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `AsyncGenerator[tuple[str, Any], None]`, —á—Ç–æ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å LangGraph, –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `AgentState -> AgentState`.

**–†–µ—à–µ–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è `_get_streaming_node_adapter()` —Å–æ–∑–¥–∞—ë—Ç –∞–¥–∞–ø—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π:
1. –í—ã–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π —É–∑–µ–ª –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ SSE —Å–æ–±—ã—Ç–∏—è
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ `EventStore` (–≤–Ω–µ state –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏)
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≤ `state["event_references"]`
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π `AgentState` –¥–ª—è LangGraph

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
# –í workflow_graph.py
if use_streaming:
    planner_adapter = _get_streaming_node_adapter(
        stream_planner_node, 
        stage_name="planning",
        fallback_key="plan",
        fallback_value=""
    )
    workflow.add_node("planner", planner_adapter)
else:
    workflow.add_node("planner", planner_node)
```

### –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫—ç—à —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `_streaming_*` —Å–æ–∑–¥–∞–≤–∞–ª–∏ race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö —Å —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

**–†–µ—à–µ–Ω–∏–µ:** `StreamingAgentsCache` —Å `threading.Lock` –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
from infrastructure.streaming_agents_cache import get_streaming_agent

# –õ–µ–Ω–∏–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ —Å –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
agent = get_streaming_agent(
    agent_type="coder",
    model="qwen2.5-coder:7b",
    temperature=0.25,
    factory=StreamingCoderAgent
)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö—ç—à –ø–æ –∫–ª—é—á—É `(agent_type, model, temperature, ...)`
- –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `threading.Lock`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞

### –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (WorkflowConfig)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è workflow –±—ã–ª–∞ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –∫–æ–¥—É.

**–†–µ—à–µ–Ω–∏–µ:** `WorkflowConfig` –¥–ª—è –µ–¥–∏–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º:

```python
from infrastructure.workflow_config import get_workflow_config

config = get_workflow_config()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
if config.streaming_enabled:
    # ...

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
if config.should_use_incremental(complexity):
    # ...

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤
timeout = config.get_stage_timeout("coding")
```

**–ú–µ—Ç–æ–¥—ã:**
- `streaming_enabled` ‚Äî –≤–∫–ª—é—á—ë–Ω –ª–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥
- `should_use_incremental(complexity)` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `get_stage_timeout(stage)` ‚Äî —Ç–∞–π–º–∞—É—Ç –¥–ª—è —ç—Ç–∞–ø–∞
- `get_temperature(stage)` ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è —ç—Ç–∞–ø–∞

### –î–µ–∫–æ—Ä–∞—Ç–æ—Ä @streaming_node

–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π:

```python
from infrastructure.workflow_decorators import streaming_node

@streaming_node(stage="planning", fallback_key="plan", fallback_value="")
async def stream_planner_node(state: AgentState) -> AsyncGenerator[tuple[str, Any], None]:
    async for event_type, data in agent.create_plan_stream(...):
        yield (event_type, data)
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ `EventStore`
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Å fallback
- –î–æ–±–∞–≤–ª—è–µ—Ç `event_references` –≤ state

### –ü–µ—Ä–µ–¥–∞—á–∞ SSE —Å–æ–±—ã—Ç–∏–π

SSE —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `EventStore` (–≤–Ω–µ state –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏), –∞ –≤ state —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏:

```python
# –í workflow_nodes.py (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä)
event_id = await event_store.save_event(event_type, data)
state["event_references"].append(event_id)

# –í backend/routers/agent.py
async for event in graph.astream(initial_state):
    for node_name, node_state in event.items():
        event_references = node_state.get("event_references", [])
        if event_references:
            # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–±—ã—Ç–∏—è –∏–∑ EventStore
            events = await event_store.get_events(event_references)
            for event in events:
                yield create_sse_event(event.event_type, event.data)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- State –Ω–µ —Ä–∞–∑–¥—É–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
- –°–æ–±—ã—Ç–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ session_id
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π (TTL)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í `config.toml`:

```toml
[streaming]
use_streaming_agents = true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ —É–∑–ª—ã
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- ‚úÖ –û–¥–∏–Ω –ø—É—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- ‚úÖ –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## Codebase Indexing (Context Engine)

–ü—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ `project_path` —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –∫–æ–¥–æ–≤—É—é –±–∞–∑—É:

```
project_path —É–∫–∞–∑–∞–Ω?
    ‚Üì –¥–∞
[ContextEngine] ‚Üí –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º
    ‚Üì
[CodeChunker] ‚Üí —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏ (–∫–ª–∞—Å—Å—ã, —Ñ—É–Ω–∫—Ü–∏–∏)
    ‚Üì
[RelevanceScorer] ‚Üí BM25-–ø–æ–¥–æ–±–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
    ‚Üì
[ContextComposer] ‚Üí —Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
    ‚Üì
–†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã ‚Üí Researcher
```

### –£–º–Ω–∞—è –æ–±—Ä–µ–∑–∫–∞ —á–∞–Ω–∫–æ–≤ (2026-01-21)

–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ `ContextComposer` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—É–º–Ω—É—é –æ–±—Ä–µ–∑–∫—É**:

- **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—á–∞–ª–æ** (60% –º–µ—Å—Ç–∞): —Å–∏–≥–Ω–∞—Ç—É—Ä–∞, docstring, –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
- **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω–µ—Ü** (40% –º–µ—Å—Ç–∞): return, yield, raise, –≤–∞–∂–Ω—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—â–∏–µ —á–∞—Å—Ç–∏
- **–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–µ–¥–∏–Ω—É** —Å –º–∞—Ä–∫–µ—Ä–æ–º `# ... (middle part truncated) ...`

**–£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞:**
- –ü–æ—Ä–æ–≥ –¥–ª—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö —á–∞–Ω–∫–æ–≤: 70% –ª–∏–º–∏—Ç–∞ (–±—ã–ª–æ 50%)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —á–∞–Ω–∫–∞: 150 —Ç–æ–∫–µ–Ω–æ–≤ (–±—ã–ª–æ 100)
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –±–æ–ª—å—à–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** [infrastructure/context_engine.md](infrastructure/context_engine.md)

## SSE Events

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

```typescript
// Frontend –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è:
event: stage_start    ‚Üí { stage: "intent", message: "..." }
event: stage_end      ‚Üí { stage: "intent", result: {...} }
event: thinking       ‚Üí { content: "..." }  // <think> –±–ª–æ–∫–∏ reasoning –º–æ–¥–µ–ª–µ–π
event: plan_chunk     ‚Üí { chunk: "..." }    // –ß–∞—Å—Ç–∏ –ø–ª–∞–Ω–∞
event: test_chunk     ‚Üí { chunk: "..." }    // –ß–∞—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤
event: code_chunk     ‚Üí { chunk: "..." }    // –ß–∞—Å—Ç–∏ –∫–æ–¥–∞
event: complete       ‚Üí { results: {...}, metrics: {...} }
event: error          ‚Üí { error_message: "..." }
```

### –ú–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–µ–¥–∞—á–∏

1. **–°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ —É–∑–ª—ã** –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ `yield (event_type, data)`
2. **–î–µ–∫–æ—Ä–∞—Ç–æ—Ä @streaming_node** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ `EventStore` (–≤–Ω–µ state)
3. **–ê–¥–∞–ø—Ç–µ—Ä—ã** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –≤ `state["event_references"]`
4. **run_workflow_stream()** –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ `EventStore` –ø–æ —Å—Å—ã–ª–∫–∞–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
5. **Frontend** –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ SSE –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç UI –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ EventStore:**
- State –Ω–µ —Ä–∞–∑–¥—É–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
- –°–æ–±—ã—Ç–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ session_id
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π (TTL = 1 —á–∞—Å)

## API Endpoints

| Endpoint | –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-------|----------|
| `/api/stream` | GET | SSE streaming (task, mode, model) |
| `/api/settings` | GET | –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `/api/models` | GET | –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ |
| `/api/conversations` | GET | –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ |
| `/api/conversations/{id}` | GET | –ü–æ–ª—É—á–∏—Ç—å –¥–∏–∞–ª–æ–≥ |
| `/api/conversations/{id}` | DELETE | –£–¥–∞–ª–∏—Ç—å –¥–∏–∞–ª–æ–≥ |
| `/api/index` | POST | –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç |

## IntentAgent ‚Äî —É–ª—É—á—à–µ–Ω–∏—è (2026-01-21)

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

IntentAgent —Ç–µ–ø–µ—Ä—å –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤:

```python
agent = IntentAgent(lazy_llm=True)
result1 = agent.determine_intent("–Ω–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é")  # LLM –≤—ã–∑–æ–≤
result2 = agent.determine_intent("–Ω–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é")  # –ò–∑ –∫—ç—à–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- In-memory –∫—ç—à –¥–æ 1000 –∑–∞–ø–∏—Å–µ–π
- –ö–ª—é—á –∫—ç—à–∞: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (lowercase, strip)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ confidence

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–∞:

```python
# –ö–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã (< 20 —Å–∏–º–≤–æ–ª–æ–≤) ‚Äî —Å–Ω–∏–∂–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ 0.1
# –î–ª–∏–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (> 100 —Å–∏–º–≤–æ–ª–æ–≤) ‚Äî –ø–æ–≤—ã—à–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ 0.05
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [MIN_CONFIDENCE, MAX_CONFIDENCE]
```

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- `MIN_CONFIDENCE = 0.3` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
- `MAX_CONFIDENCE = 0.95` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤:

```python
# –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
language = agent._detect_language("–Ω–∞–ø–∏—à–∏ –∫–æ–¥")  # "ru"
language = agent._detect_language("write code")   # "en"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- Structured –ø—Ä–æ–º–ø—Ç—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (–ª—É—á—à–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- Legacy –ø—Ä–æ–º–ø—Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

–ï–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ `_get_prompt()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤:

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—Ä–æ–º–ø—Ç
prompt = agent._get_prompt(query, is_structured=True)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É structured/legacy
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏

## Dependency Injection

### DependencyContainer (`backend/dependencies.py`)

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ (2026-01-21):**
- ‚úÖ **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `threading.Lock` —Å double-checked locking
- ‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è RAGSystem** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ config** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `config.rag_persist_directory` –∏ `config.rag_code_collection`
- ‚úÖ **Graceful shutdown** ‚Äî –º–µ—Ç–æ–¥ `shutdown()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from backend.dependencies import get_memory_agent, get_rag_system, shutdown_dependencies

# –ü–æ–ª—É—á–µ–Ω–∏–µ singleton –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
memory = get_memory_agent()
rag = get_rag_system(collection_name="task_memory")  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π

# –ü—Ä–∏ shutdown
shutdown_dependencies()
```

## Connection Pool

### OllamaConnectionPool (`infrastructure/connection_pool.py`)

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Ollama API —á–µ—Ä–µ–∑ httpx.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ (2026-01-21):**
- ‚úÖ **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø—É–ª —Å `threading.Lock`
- ‚úÖ **HTTP/2 –∏ connection pooling** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è production
- ‚úÖ **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ** ‚Äî –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ FastAPI lifespan
- ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
- ‚úÖ **Streaming –ø–æ–¥–¥–µ—Ä–∂–∫–∞** ‚Äî –º–µ—Ç–æ–¥ `generate_stream()` –¥–ª—è streaming –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from infrastructure.connection_pool import get_ollama_pool

pool = await get_ollama_pool()
result = await pool.generate(model="qwen2.5-coder:7b", prompt="...")

# Streaming
async for chunk in pool.generate_stream(model="...", prompt="..."):
    if chunk.get("done"):
        break
    content = chunk.get("response", "")
```

## LocalLLM

### –£–ª—É—á—à–µ–Ω–∏—è (2026-01-21)

**JSON –ø–∞—Ä—Å–∏–Ω–≥:**
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö JSON —Å—Ç—Ä—É–∫—Ç—É—Ä —á–µ—Ä–µ–∑ —Å—Ç–µ–∫
- ‚úÖ –£—á—ë—Ç —Å—Ç—Ä–æ–∫ –≤ JSON (—Å–∫–æ–±–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–æ–∫ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ escape-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π

**ThreadPoolExecutor:**
- ‚úÖ –û–±—â–∏–π –∫–ª–∞—Å—Å–æ–≤—ã–π executor –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏ shutdown

## IntentAgent ‚Äî —É–ª—É—á—à–µ–Ω–∏—è (2026-01-21)

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

IntentAgent —Ç–µ–ø–µ—Ä—å –∫—ç—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤:

```python
agent = IntentAgent(lazy_llm=True)
result1 = agent.determine_intent("–Ω–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é")  # LLM –≤—ã–∑–æ–≤
result2 = agent.determine_intent("–Ω–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü–∏—é")  # –ò–∑ –∫—ç—à–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- In-memory –∫—ç—à –¥–æ 1000 –∑–∞–ø–∏—Å–µ–π
- –ö–ª—é—á –∫—ç—à–∞: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (lowercase, strip)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ confidence

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–∞:

```python
# –ö–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã (< 20 —Å–∏–º–≤–æ–ª–æ–≤) ‚Äî —Å–Ω–∏–∂–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ 0.1
# –î–ª–∏–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (> 100 —Å–∏–º–≤–æ–ª–æ–≤) ‚Äî –ø–æ–≤—ã—à–∞–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ 0.05
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [MIN_CONFIDENCE, MAX_CONFIDENCE]
```

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã:**
- `MIN_CONFIDENCE = 0.3` ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
- `MAX_CONFIDENCE = 0.95` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤:

```python
# –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
language = agent._detect_language("–Ω–∞–ø–∏—à–∏ –∫–æ–¥")  # "ru"
language = agent._detect_language("write code")   # "en"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- Structured –ø—Ä–æ–º–ø—Ç—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (–ª—É—á—à–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- Legacy –ø—Ä–æ–º–ø—Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

–ï–¥–∏–Ω—ã–π –º–µ—Ç–æ–¥ `_get_prompt()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤:

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—Ä–æ–º–ø—Ç
prompt = agent._get_prompt(query, is_structured=True)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–∂–¥—É structured/legacy
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config.toml —Å–µ–∫—Ü–∏–∏

| –°–µ–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `[default]` | –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–º–æ–¥–µ–ª—å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞) |
| `[llm]` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ LLM (—Ç–æ–∫–µ–Ω—ã) |
| `[interaction]` | –†–µ–∂–∏–º—ã (default_mode, chat_model) |
| `[hardware]` | –õ–∏–º–∏—Ç—ã (VRAM, heavy/ultra –º–æ–¥–µ–ª–∏) |
| `[quality]` | –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ + –ø–æ—Ä–æ–≥–∏ –¥–ª—è ModelRouter (`min_quality_simple/medium/complex`) |
| `[web_search]` | –í–µ–±-–ø–æ–∏—Å–∫ |
| `[rag]` | ChromaDB –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (`persist_directory`, `code_collection`, `memory_collection`) |
| `[persistence]` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á |
| `[context_engine]` | –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã |
| `[streaming]` | –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–µ —É–∑–ª—ã –≤ workflow (`use_streaming_agents`) |
| `[incremental_coding]` | –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (`enabled`, `min_complexity`) |
| `[timeouts]` | –¢–∞–π–º–∞—É—Ç—ã –¥–ª—è —ç—Ç–∞–ø–æ–≤ workflow |
| `[circuit_breaker]` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Circuit Breaker (`failure_threshold`, `recovery_timeout`) |
| `[ollama]` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Ollama (`host`, `connection_pool_size`, `timeout`) |

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π

–ú–æ–¥–µ–ª–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `ollama.list()`. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É.

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞

1. –°–æ–∑–¥–∞—Ç—å `agents/new_agent.py`
2. –î–æ–±–∞–≤–∏—Ç—å —É–∑–µ–ª –≤ `infrastructure/workflow_nodes.py`
3. –î–æ–±–∞–≤–∏—Ç—å –≤ –≥—Ä–∞—Ñ `infrastructure/workflow_graph.py`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

1. –î–æ–±–∞–≤–∏—Ç—å –≤ `InteractionMode` enum
2. –°–æ–∑–¥–∞—Ç—å `run_<mode>_stream()` —Ñ—É–Ω–∫—Ü–∏—é
3. –î–æ–±–∞–≤–∏—Ç—å —Ä–æ—É—Ç–∏–Ω–≥ –≤ `stream_task_results()`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Rate Limiting (middleware)
- CORS (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ origins)
- Input Validation (Pydantic)
- Error Handling (–Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest tests/                    # –í—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/ --cov=agents       # –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/test_intent.py -v   # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
```
